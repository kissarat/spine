<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Swine</title>
    <link rel="alternate" type="text/svg+"/>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #spine {
            height: 90vh;
        }

        #hernia {
            visibility: hidden;
        }

        #hernia.active {
            visibility: visible;
        }

        #hernia.scaled {
            transform: scale(1.5);
        }
    </style>
    <style id="spine-style">
        path {
            cursor: pointer;
        }

        path:not([id^="D"]):not(.active):hover,
        path.active:not([id^="D"]) {
            animation: 1s vertebral infinite;
        }

        path[id^="D"]:not(.active):hover,
        path[id^="D"].active {
            animation: 1s intervertebral infinite;
        }

        @keyframes vertebral {
            50% {
                opacity: 0.8;
                transform: translate(6px, 0);
            }
        }

        @keyframes intervertebral {
            50% {
                transform: translate(-12px, 0);
            }
        }

        .hidden {
            display: none;
        }

        #gCERVIX.active {
            transform: scale(2) translate(-100px, 0);
        }

        #gTHORAX.active {
            transform: scale(1.5) translate(-60px, -150px);
        }

        #gLUMBAR.active {
            transform: scale(2) translate(-100px, -450px);
        }
    </style>
</head>
<body>
<object id="spine" data="spine.svg" type="image/svg+xml"></object>
<object id="hernia" data="hernia.svg" type="image/svg+xml"></object>

<script>
  function someHasClass(selector, className = 'active') {
    return [].some.call(spine.contentDocument.querySelectorAll(selector), p => p.classList.contains(className))
  }

  function setupSpine() {
    this.contentDocument.rootElement.appendChild(document.getElementById('spine-style'));
    for (const path of this.contentDocument.querySelectorAll('path')) {
      path.addEventListener('click', function () {
        this.style.strokeWidth = this.classList.toggle('active') ? '4px' : '1px';
        const hasActive = someHasClass('path')
        hernia.classList.toggle('active', hasActive)
        hernia.classList.toggle('scaled', someHasClass('[id^="D"]'))
        for (const part of spine.contentDocument.querySelectorAll('g')) {
          part.classList.toggle(part === path.parentNode ? 'active' : 'hidden', hasActive)
        }
      })
    }
  }

  let spine
  let hernia
  document.addEventListener('DOMContentLoaded', function () {
    spine = document.getElementById('spine')
    hernia = document.getElementById('hernia')
    spine.addEventListener('load', setupSpine)
  })
</script>
</body>
</html>
